# scan all .py and .php files in /opt/ictf/ directory
# and find keywords regarding vulnerability

import os

rootpath = '/opt/ictf/'
keywords = ['strcpy', 'strncpy', 'scanf', 'gets', 'printf', 'system', 'popen', 'exec', 'include']

if __name__ == '__main__':
    for root, dirs, files in os.walk(rootpath):
        for file in files:
            if file.endswith('.c') or file.endswith('.php'):
                filepath = os.path.join(root, file)
                print('In ' + filepath)
                with open(filepath, 'r') as f:
                    line_num = 0
                    for line in f:
                        line_num += 1
                        for word in keywords:
                            if word in line:
                                print('  ' + word + ' is found in line ' + str(line_num))
